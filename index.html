<html>
  <head>
    <meta charset="utf-8" />
    <title>My Island VR</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-super-hands-component@4.0.5/dist/aframe-super-hands.min.js"></script>
  </head>
  <body>
    <a-scene
      vr-mode-ui="enabled: true"
      renderer="antialias: true"
      background="color: #ECECEC"
    >
      <!-- Camera Rig with Teleportation -->
      <a-entity id="cameraRig" movement-controls position="0 1.6 0">
        <a-entity id="head" camera look-controls wasd-controls position="0 0 0">
        </a-entity>

        <!-- Laser Controllers for VR input -->
        <a-entity
          laser-controls="hand: left"
          raycaster="objects: .clickable"
        ></a-entity>
        <a-entity
          laser-controls="hand: right"
          raycaster="objects: .clickable"
        ></a-entity>
      </a-entity>

      <!-- Teleportation -->
      <a-entity
        teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head; button: trigger;"
        raycaster="objects: [ground]"
      ></a-entity>

      <!-- Lights -->
      <a-entity light="type: ambient; color: #888"></a-entity>
      <a-entity
        light="type: directional; color: #fff; intensity: 1"
        position="0 10 5"
      ></a-entity>

      <!-- Ground -->
      <a-plane
        position="0 0 -4"
        rotation="-90 0 0"
        width="50"
        height="50"
        color="#7BC8A4"
        class="clickable"
        id="ground"
      ></a-plane>

      <!-- Models -->
      <a-entity
        id="owl"
        class="clickable"
        position="3 1.5 -5"
        gltf-model="#owlModel"
        scale="1 1 1"
        animation-mixer
        sound="src: #owlSound; on: click"
      ></a-entity>
      <a-entity
        id="elk"
        class="clickable"
        position="-2 0 -5"
        gltf-model="#elkModel"
        scale="1 1 1"
        sound="src: #elkSound; on: click"
      ></a-entity>
      <a-entity
        id="ladyflowers"
        class="clickable"
        position="0 0 -3"
        gltf-model="#ladyModel"
        scale="1 1 1"
        sound="src: #ladySound; on: click"
      ></a-entity>

      <!-- Background audio -->
      <a-sound
        src="#ambientSound"
        autoplay="true"
        loop="true"
        volume="0.3"
      ></a-sound>

      <!-- Assets -->
      <a-assets>
        <a-asset-item id="owlModel" src="models/owl.glb"></a-asset-item>
        <a-asset-item id="elkModel" src="models/elk.glb"></a-asset-item>
        <a-asset-item
          id="ladyModel"
          src="models/ladyflowers.glb"
        ></a-asset-item>
        <audio id="owlSound" src="audio/owl.mp3"></audio>
        <audio id="elkSound" src="audio/elk.mp3"></audio>
        <audio id="ladySound" src="audio/ladyflowers.mp3"></audio>
        <audio id="ambientSound" src="audio/ambient.mp3"></audio>
      </a-assets>

      <!-- JavaScript Interaction -->
      <script>
        AFRAME.registerComponent("click-animation", {
          init: function () {
            this.el.addEventListener("click", () => {
              if (this.el.id === "elk") {
                this.el.setAttribute("animation", {
                  property: "position",
                  to: "-2 0 -2",
                  dur: 3000,
                  easing: "easeInOutQuad",
                });
              } else if (this.el.id === "owl") {
                this.el.setAttribute("animation", {
                  property: "rotation",
                  to: "0 360 0",
                  dur: 2000,
                });
              }
            });

            this.el.addEventListener("mouseenter", () => {
              this.el.setAttribute("scale", "1.2 1.2 1.2");
            });
            this.el.addEventListener("mouseleave", () => {
              this.el.setAttribute("scale", "1 1 1");
            });
          },
        });

        document.querySelectorAll(".clickable").forEach((el) => {
          el.setAttribute("click-animation", "");
        });
      </script>
    </a-scene>
  </body>
</html>
